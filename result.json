{"Resources":{"ApiGatewayIntegrationSqsTestQueue":{"Type":"AWS::SQS::Queue","Properties":{"QueueName":"test-api-gateway-integration-sqs-test-queue","VisibilityTimeout":60,"RedrivePolicy":{"deadLetterTargetArn":{"Fn::GetAtt":["ApiGatewayIntegrationSqsTestQueueDlq","Arn"]},"maxReceiveCount":1}}},"ApiGatewayIntegrationSqsTestQueueDlq":{"Type":"AWS::SQS::Queue","Properties":{"QueueName":"test-api-gateway-integration-sqs-test-queue-dlq","MessageRetentionPeriod":1209600}},"ApiGatewayIntegrationSqsTestQueueApiGatewayResource":{"Type":"AWS::ApiGateway::Resource","Properties":{"ParentId":{"Fn::GetAtt":["test","RootResourceId"]},"PathPart":"test-queue","RestApiId":{"Ref":"test"}}},"ApiGatewayIntegrationSqsTestQueueIAMRole":{"Type":"AWS::IAM::Role","Properties":{"Path":"/","AssumeRolePolicyDocument":{"Version":"2012-10-17","Statement":[{"Effect":"Allow","Principal":{"Service":["apigateway.amazonaws.com"]},"Action":"sts:AssumeRole"}]},"ManagedPolicyArns":["arn:aws:iam::aws:policy/service-role/AmazonAPIGatewayPushToCloudWatchLogs"],"Policies":[{"PolicyName":"ApiGatewayIntegrationSqsTestQueuePolicy","PolicyDocument":{"Version":"2012-10-17","Statement":[{"Effect":"Allow","Action":["sqs:SendMessage"],"Resource":{"Fn::GetAtt":["ApiGatewayIntegrationSqsTestQueue","Arn"]}}]}}]}},"ApiGatewayIntegrationSqsTestQueueMethod":{"Type":"AWS::ApiGateway::Method","DependsOn":"ApiGatewayIntegrationSqsTestQueue","Properties":{"RestApiId":{"Ref":"test"},"ResourceId":{"Ref":"ApiGatewayIntegrationSqsTestQueueApiGatewayResource"},"HttpMethod":"POST","AuthorizationType":"NONE","MethodResponses":[{"StatusCode":"200","ResponseParameters":{"method.response.header.Access-Control-Allow-Origin":true}}],"Integration":{"Type":"AWS","Credentials":{"Fn::GetAtt":["ApiGatewayIntegrationSqsTestQueueIAMRole","Arn"]},"IntegrationHttpMethod":"POST","IntegrationResponses":[{"StatusCode":"200","ResponseParameters":{"method.response.header.Access-Control-Allow-Origin":"'*'"}}],"RequestParameters":{"integration.request.querystring.QueueUrl":"'#{ApiGatewayIntegrationSqsTestQueue}'","integration.request.querystring.MessageBody":"method.request.body"},"Uri":"arn:aws:apigateway:us-east-test-1:sqs:action/SendMessage"}}},"ApiGatewayIntegrationSqsTestQueueMockMethod":{"Type":"AWS::ApiGateway::Method","DependsOn":"ApiGatewayIntegrationSqsTestQueue","Properties":{"RestApiId":{"Ref":"test"},"ResourceId":{"Ref":"ApiGatewayIntegrationSqsTestQueueApiGatewayResource"},"HttpMethod":"OPTIONS","AuthorizationType":"NONE","MethodResponses":[{"StatusCode":"200","ResponseParameters":{"method.response.header.Access-Control-Allow-Origin":true,"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Methods":true,"method.response.header.Access-Control-Allow-Credentials":true}}],"Integration":{"Type":"MOCK","Credentials":{"Fn::GetAtt":["ApiGatewayIntegrationSqsTestQueueIAMRole","Arn"]},"RequestTemplates":{"application/json":"{statusCode:200}"},"IntegrationResponses":[{"StatusCode":"200","ResponseParameters":{"method.response.header.Access-Control-Allow-Origin":"'*'","method.response.header.Access-Control-Allow-Headers":"'Content-Type,x-api-token,authorizationtoken,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'","method.response.header.Access-Control-Allow-Methods":"'OPTIONS,POST'","method.response.header.Access-Control-Allow-Credentials":"'true'"},"ResponseTemplates":{"application/json":""}}]}}},"test":{"Type":"AWS::ApiGateway::Deployment","DependsOn":["ApiGatewayIntegrationSqsTestQueueMethod"],"Properties":{"RestApiId":{"Ref":"test"},"StageName":"test"}}},"Outputs":{"ApiGatewayIntegrationSqsTestQueueArn":{"Value":{"Fn::GetAtt":["ApiGatewayIntegrationSqsTestQueue","Arn"]}},"ApiGatewayIntegrationSqsTestQueueDlqArn":{"Value":{"Fn::GetAtt":["ApiGatewayIntegrationSqsTestQueueDlq","Arn"]}},"ServiceEndpoint":{"Description":"URL of the service endpoint","Value":"https://#{test}.execute-api.us-east-test-1.amazonaws.com/test"}}}